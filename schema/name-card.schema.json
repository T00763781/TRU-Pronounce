{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.invalid/schema/name-card.schema.json",
  "title": "TRU Pronounce Name Card",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schemaVersion",
    "cardId",
    "createdAt",
    "submittedAt",
    "approvedAt",
    "phase",
    "name",
    "pronunciation",
    "tts",
    "recording",
    "moderation",
    "provenance"
  ],
  "properties": {
    "schemaVersion": {
      "type": "string",
      "description": "Schema version for the Name Card payload (e.g. '0.1')."
    },
    "cardId": {
      "type": "string",
      "description": "Stable identifier for this card (filename/key in the library)."
    },
    "createdAt": { "type": "string", "format": "date-time" },
    "submittedAt": { "type": ["string", "null"], "format": "date-time" },
    "approvedAt": { "type": ["string", "null"], "format": "date-time" },
    "phase": {
      "type": "string",
      "description": "Lifecycle phase (e.g. 'authoring', 'submitted', 'approved'). Kept flexible."
    },
    "name": {
      "type": "object",
      "additionalProperties": false,
      "required": ["raw", "display"],
      "properties": {
        "raw": { "type": "string" },
        "display": { "type": "string" }
      }
    },
    "pronunciation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["autoSyllables", "finalSyllables", "ipa", "plainGuidance"],
      "properties": {
        "autoSyllables": {
          "type": "array",
          "items": { "type": "string" }
        },
        "finalSyllables": {
          "type": "array",
          "items": { "type": "string" }
        },
        "ipa": { "type": "string" },
        "plainGuidance": { "type": "string" }
      }
    },
    "tts": {
      "type": "object",
      "additionalProperties": false,
      "required": ["engine", "voice", "payload"],
      "properties": {
        "engine": {
          "type": "string",
          "description": "Text-to-speech engine identifier (e.g. 'web-speech-api')."
        },
        "voice": {
          "type": "object",
          "additionalProperties": false,
          "required": ["label", "voiceURI", "lang", "localService"],
          "properties": {
            "label": { "type": ["string", "null"] },
            "voiceURI": { "type": ["string", "null"] },
            "lang": { "type": ["string", "null"] },
            "localService": { "type": ["boolean", "null"] }
          }
        },
        "payload": {
          "type": ["string", "null"],
          "description": "CRITICAL: exact text payload sent to the TTS engine (may be null if unavailable)."
        },
        "notes": { "type": "string" }
      }
    },
    "recording": {
      "type": "object",
      "additionalProperties": false,
      "required": ["hasRecording", "audioFile", "format", "durationMs"],
      "properties": {
        "hasRecording": { "type": "boolean" },
        "audioFile": { "type": ["string", "null"] },
        "format": { "type": ["string", "null"] },
        "durationMs": { "type": ["number", "null"] }
      }
    },
    "moderation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["status", "reviewNotes"],
      "properties": {
        "status": {
          "type": "string",
          "enum": ["draft", "submitted", "needs-review", "approved", "rejected"]
        },
        "reviewNotes": { "type": ["string", "null"] }
      }
    },
    "provenance": {
      "type": "object",
      "additionalProperties": false,
      "required": ["createdWith", "appVersion", "device", "userSubmitted"],
      "properties": {
        "createdWith": { "type": "string" },
        "appVersion": { "type": "string" },
        "device": { "type": "string" },
        "userSubmitted": { "type": "boolean" }
      }
    }
  }
}
